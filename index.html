<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
<title>Mon Pizzagramme ‚Äî Calculateur de p√¢te √† pizza</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#01c9d9">
<link rel="icon" href="favicon.png">

<style>
:root{
  --turq: #01c9d9;
  --turq-deep: #0f5f6a;
  --bg-dark: #0f1415;
  --card-bg: #f4f5f6;
  --muted: #9aa0a6;
  --radius: 12px;
  --accent: #018b90;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  background: linear-gradient(180deg,var(--bg-dark), #061011);
  color: #eef2f3;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}

/* Header */
.header{
  display:flex;
  align-items:center;
  gap:12px;
  padding:14px 18px;
  background: linear-gradient(180deg,var(--turq),var(--turq-deep));
  box-shadow: 0 8px 30px rgba(1,127,134,0.12);
  position:sticky;
  top:0;
  z-index:40;
}
.logo-badge{
  width:52px;height:52px;border-radius:12px;
  background:linear-gradient(180deg,#2de0df,#01aab0);
  display:flex;align-items:center;justify-content:center;
  font-size:26px;color:white;
  box-shadow:0 8px 24px rgba(1,127,134,0.25);
  border:1px solid rgba(255,255,255,0.06);
}
.header-title{font-weight:700;color:#fff;font-size:18px}

/* Layout */
.container{max-width:1100px;margin:20px auto;padding:18px}
.card{background:var(--card-bg);color:#0b1220;border-radius:12px;padding:16px;box-shadow:0 12px 40px rgba(2,6,8,0.06);margin-top:18px}
.controls{display:grid;grid-template-columns:1fr 1fr;gap:14px}
@media(max-width:900px){.controls{grid-template-columns:1fr}}
label{display:block;color:var(--muted);margin-top:10px;font-weight:600}
input[type=number], select, button, input[type=range]{width:100%;padding:10px;border-radius:8px;border:1px solid #e6eef2;font-size:15px;background:#fff;color:#111}
.result-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:12px}
.result-grid div{background:#fff;padding:12px;border-radius:8px;text-align:center;border:1px solid rgba(3,7,8,0.04)}
.footer{padding:12px;text-align:center;color:var(--muted);font-size:0.9rem;margin-top:12px}

/* textured calculator area */
.texture {
  background-image: radial-gradient(circle at 10px 10px, rgba(0,0,0,0.02) 0px, rgba(0,0,0,0.00) 2px);
  background-size: 12px 12px;
}

/* splash */
.splash{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;flex-direction:column;gap:10px;background:linear-gradient(180deg,var(--turq),var(--turq-deep));z-index:9999}
.splash-bubble{width:160px;height:160px;border-radius:50%;background:radial-gradient(circle at 25% 25%, rgba(255,255,255,0.18), rgba(255,255,255,0.03));display:flex;align-items:center;justify-content:center;font-size:44px;color:#fff;box-shadow:0 18px 40px rgba(1,127,134,0.28);transform:scale(0.7);opacity:0}
.splash-title{color:#fff;font-weight:800;font-size:26px}
.splash-sub{color:rgba(255,255,255,0.92)}

/* decorative bubbles */
.bubbles-wrap{position:fixed;inset:0;pointer-events:none;z-index:10;overflow:hidden}
.bubble{position:absolute;border-radius:50%;background:radial-gradient(circle at 30% 30%,rgba(255,255,255,0.12),rgba(255,255,255,0.02));opacity:0.22;filter:blur(6px);animation:float 6s linear infinite}
.b1{width:18vmin;height:18vmin;left:6%;top:6%}
.b2{width:14vmin;height:14vmin;right:8%;top:20%}
.b3{width:20vmin;height:20vmin;left:48%;bottom:4%}
.b4{width:16vmin;height:16vmin;right:28%;bottom:18%}
@keyframes float{0%{transform:translateY(0)}50%{transform:translateY(-20px)}100%{transform:translateY(0)}}

/* small UI */
.btn {cursor:pointer;border-radius:8px;padding:10px;border:none}
.btn-secondary{background:#fff;color:var(--turq)}
.btn-primary{background:var(--turq-deep);color:#fff}
.timer{display:flex;gap:8px;align-items:center;margin-top:10px}
.toast{position:fixed;left:50%;transform:translateX(-50%);bottom:28px;background:var(--turq);color:#fff;padding:10px 14px;border-radius:12px;display:none;box-shadow:0 8px 24px rgba(1,201,217,0.18);z-index:10000}

/* little signature */
.by-steff{position:fixed;right:12px;bottom:8px;font-size:12px;color:rgba(255,255,255,0.85);z-index:60}
</style>
</head>
<body>

<!-- Splash (1.5s) -->
<div class="splash" id="splash" aria-hidden="false">
  <div class="splash-bubble" id="splashBubble">üçï</div>
  <div class="splash-title">Mon Pizzagramme</div>
  <div class="splash-sub">Ta p√¢te parfaite en un clic !</div>
  <div style="font-size:13px;opacity:0.95">par Steff</div>
</div>

<!-- decorative bubbles -->
<div class="bubbles-wrap" id="bubbles" aria-hidden="true">
  <div class="bubble b1"></div>
  <div class="bubble b2"></div>
  <div class="bubble b3"></div>
  <div class="bubble b4"></div>
</div>

<!-- Header -->
<header class="header">
  <div style="display:flex;align-items:center;gap:12px">
    <div class="logo-badge" id="headerBadge">üçï</div>
    <div class="header-title">Mon Pizzagramme</div>
  </div>
</header>

<!-- Main -->
<div class="container">
  <div class="card texture" id="calculatorCard">
    <div style="display:flex;align-items:center;justify-content:space-between;gap:12px">
      <div style="font-weight:700">Calculateur de p√¢te √† pizza</div>
      <div style="color:var(--muted)">Version 2025 ¬∑ par Steff</div>
    </div>

    <div class="controls" style="margin-top:12px">
      <div>
        <label for="preset">Type de pizza</label>
        <select id="preset" aria-label="Type de pizza"></select>

        <label for="numBalls">Nombre de p√¢tons</label>
        <input id="numBalls" type="number" value="4" min="1" inputmode="numeric" aria-label="Nombre de patons"/>

        <label for="weightPerBall">Poids par p√¢ton (g)</label>
        <input id="weightPerBall" type="number" value="250" min="50" inputmode="numeric" aria-label="Poids par paton"/>
      </div>

      <div>
        <label for="totalWeight">Poids total de p√¢te (g)</label>
        <input id="totalWeight" type="number" value="1000" min="100" inputmode="numeric" aria-label="Poids total"/>

        <label for="hydration">Hydratation (%) <span id="hydrationVal">60%</span></label>
        <input id="hydration" type="range" min="40" max="90" value="60" aria-label="Hydratation"/>

        <label for="saltPct">Sel (% farine)</label>
        <input id="saltPct" type="number" value="2" min="0" max="5" aria-label="Sel pourcentage"/>
      </div>
    </div>

    <div class="card-result" aria-live="polite">
      <h3>Ingr√©dients</h3>
      <div class="result-grid" id="resultGrid">
        <div><small>Farine</small><div id="flour">0 g</div></div>
        <div><small>Eau</small><div id="water">0 g</div></div>
        <div><small>Sel</small><div id="salt">0 g</div></div>
        <div><small>Levure instant.</small><div id="yeast">0 g</div></div>
        <div style="grid-column:1/-1"><small>Levure fra√Æche (approx.)</small><div id="yeastFresh">0 g</div></div>
        <div style="grid-column:1/-1"><small>Total p√¢te</small><div id="totalDesc">0 g</div></div>
      </div>

      <h4 style="margin-top:12px">Calculateur temp√©rature d'eau</h4>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <input id="desiredDoughTemp" type="number" value="24" min="10" max="35" style="width:120px" aria-label="Temp√©rature d√©sir√©e p√¢te"/> 
        <input id="flourTemp" type="number" value="20" min="0" max="40" style="width:120px" aria-label="Temp√©rature farine"/>
        <input id="roomTemp" type="number" value="22" min="0" max="40" style="width:120px" aria-label="Temp√©rature pi√®ce"/>
        <button id="calcWaterTemp" class="btn btn-primary" style="width:140px">Calculer eau (¬∞C)</button>
      </div>
      <div style="margin-top:8px"><small>Temp. eau n√©cessaire: <span id="waterTemp">-- ¬∞C</span></small></div>

      <h4 style="margin-top:12px">Timer</h4>
      <div class="timer">
        <input id="timerMin" type="number" value="0" min="0" style="width:80px"/>
        <input id="timerSec" type="number" value="30" min="0" max="59" style="width:80px"/>
        <button id="startTimer" class="btn btn-primary">D√©marrer</button>
        <button id="stopTimer" class="btn btn-secondary">Arr√™ter</button>
        <div id="timerDisplay" style="font-weight:700;margin-left:8px">00:30</div>
      </div>
    </div>

    <div style="display:flex;gap:8px;margin-top:12px">
      <button id="resetBtn">üîÅ R√©initialiser</button>
      <button id="applyPreset" class="btn btn-primary">Appliquer preset</button>
    </div>

    <div class="footer">¬© 2025 ‚Äî Mon Pizzagramme ¬∑ par Steff</div>
  </div>
</div>

<div class="by-steff">by Steff</div>

<!-- sounds (standard placeholders; remplacez par vos sons) -->
<audio id="pop" src="pop.mp3" preload="auto"></audio>
<audio id="ding" src="ding.mp3" preload="auto"></audio>

<script>
/* --- Presets --- */
const PRESETS = {
  "Napolitaine":{hydration:0.60,saltPct:0.02,yeastPct:0.002},
  "Romaine":{hydration:0.65,saltPct:0.02,yeastPct:0.002},
  "New York":{hydration:0.62,saltPct:0.02,yeastPct:0.0015},
  "Detroit":{hydration:0.70,saltPct:0.02,yeastPct:0.0025},
  "Biga":{hydration:0.58,saltPct:0.02,yeastPct:0.0015}
};

/* --- UI refs --- */
const presetSel = document.getElementById('preset');
Object.keys(PRESETS).forEach(k=>{ const o=document.createElement('option'); o.value=k; o.textContent=k; presetSel.appendChild(o); });
presetSel.value = 'Napolitaine';

const numBallsEl = document.getElementById('numBalls');
const weightPerBallEl = document.getElementById('weightPerBall');
const totalWeightEl = document.getElementById('totalWeight');
const hydrationEl = document.getElementById('hydration');
const hydrationVal = document.getElementById('hydrationVal');
const saltPctEl = document.getElementById('saltPct');

const flourEl = document.getElementById('flour'), waterEl = document.getElementById('water'), saltEl = document.getElementById('salt'), yeastEl = document.getElementById('yeast'), yeastFreshEl = document.getElementById('yeastFresh'), totalDescEl = document.getElementById('totalDesc');

let timerInterval = null;

/* --- Recalc function (syncs fields bidirectionally) --- */
function recalc(from){
  const nb = Math.max(1, Number(numBallsEl.value) || 1);
  let wp = Math.max(1, Number(weightPerBallEl.value) || 250);
  let total = Math.max(1, Number(totalWeightEl.value) || Math.round(nb*wp));

  if(from === 'wp' || from === 'nb'){
    total = Math.round(nb * wp);
    totalWeightEl.value = total;
  } else if(from === 'total'){
    wp = Math.round(total / nb);
    weightPerBallEl.value = wp;
  } else {
    total = Math.round(nb * wp);
    totalWeightEl.value = total;
  }

  const hyd = Number(hydrationEl.value) / 100;
  const p = PRESETS[presetSel.value] || PRESETS['Napolitaine'];
  const saltPct = Number(saltPctEl.value)/100 || p.saltPct;
  const yeastPct = p.yeastPct;

  const combine = 1 + hyd + saltPct + yeastPct;
  const F = total / combine;
  const W = F * hyd;
  const S = F * saltPct;
  const Y = F * yeastPct;

  flourEl.textContent = Math.round(F) + ' g';
  waterEl.textContent = Math.round(W) + ' g';
  saltEl.textContent = S.toFixed(1) + ' g';
  yeastEl.textContent = Y.toFixed(2) + ' g';
  yeastFreshEl.textContent = (Y * 3).toFixed(2) + ' g (approx.)';
  totalDescEl.textContent = total + ' g ‚Äî ' + nb + ' p√¢tons √ó ' + wp + ' g';

  hydrationVal.textContent = Math.round(hyd * 100) + '%';
}

/* --- Event wiring --- */
numBallsEl.addEventListener('input', ()=>recalc('nb'));
weightPerBallEl.addEventListener('input', ()=>recalc('wp'));
totalWeightEl.addEventListener('input', ()=>recalc('total'));
hydrationEl.addEventListener('input', ()=>recalc());
saltPctEl.addEventListener('input', ()=>recalc());
presetSel.addEventListener('change', ()=>{
  const p = PRESETS[presetSel.value];
  hydrationEl.value = Math.round(p.hydration * 100);
  hydrationVal.textContent = Math.round(p.hydration * 100) + '%';
  saltPctEl.value = Math.round(p.saltPct * 100);
  recalc();
});

document.getElementById('applyPreset').addEventListener('click', ()=>presetSel.dispatchEvent(new Event('change')));
document.getElementById('resetBtn').addEventListener('click', ()=>{
  numBallsEl.value = 4; weightPerBallEl.value = 250; hydrationEl.value = 60; saltPctEl.value = 2;
  hydrationVal.textContent = '60%';
  recalc();
});

/* --- Water temp calculator --- */
document.getElementById('calcWaterTemp').addEventListener('click', ()=>{
  const DDT = Number(document.getElementById('desiredDoughTemp').value) || 24;
  const flourT = Number(document.getElementById('flourTemp').value) || 20;
  const roomT = Number(document.getElementById('roomTemp').value) || 22;
  const friction = 2;
  const waterT = Math.round(DDT * 3 - flourT - roomT - friction);
  document.getElementById('waterTemp').textContent = waterT + ' ¬∞C';
});

/* --- Timer --- */
function pad(n){ return n<10 ? '0'+n : n; }
document.getElementById('startTimer').addEventListener('click', ()=>{
  const min = Math.max(0, Number(document.getElementById('timerMin').value) || 0);
  const sec = Math.max(0, Number(document.getElementById('timerSec').value) || 0);
  let total = min*60 + sec;
  if(timerInterval) clearInterval(timerInterval);
  document.getElementById('timerDisplay').textContent = pad(Math.floor(total/60)) + ':' + pad(total%60);
  timerInterval = setInterval(()=>{
    total--;
    document.getElementById('timerDisplay').textContent = pad(Math.floor(total/60)) + ':' + pad(total%60);
    if(total<=0){ clearInterval(timerInterval); timerInterval=null; try{ document.getElementById('ding').play().catch(()=>{});}catch(e){} }
  },1000);
});
document.getElementById('stopTimer').addEventListener('click', ()=>{
  if(timerInterval) { clearInterval(timerInterval); timerInterval=null; }
});

/* --- Splash & bubbles sequence --- */
document.addEventListener('DOMContentLoaded', ()=>{
  recalc();
  const splash = document.getElementById('splash');
  const splashBubble = document.getElementById('splashBubble');
  const pop = document.getElementById('pop');
  const ding = document.getElementById('ding');
  // animate splash bubble
  splashBubble.style.transition = 'transform 1.5s cubic-bezier(.2,.9,.3,1), opacity .6s';
  splashBubble.style.transform = 'scale(1)';
  splashBubble.style.opacity = '1';
  // play pop
  setTimeout(()=>{ try{ pop.play().catch(()=>{}); }catch(e){} }, 200);
  setTimeout(()=>{ try{ ding.play().catch(()=>{}); }catch(e){} }, 800);
  // hide splash after 1.5s
  setTimeout(()=>{ splash.style.transition='opacity .6s'; splash.style.opacity=0;
    setTimeout(()=>{ splash.style.display='none'; recalc(); },620);
  },1500);
  // stop bubble animations after 3s
  setTimeout(()=>{ document.querySelectorAll('.bubble').forEach(b=>b.style.animation='none'); },3000);

  // service worker registration (if file present)
  if('serviceWorker' in navigator){
    navigator.serviceWorker.register('service-worker.js').catch(()=>{ /* ignore */ });
  }
});
</script>
</body>
</html>
